# Architecture Refactoring Brief: Tempo TNS & Agentic Passport

## 1. Концептуальный сдвиг (The Core Shift)
Текущая реализация TNS (Tempo Name Service) ориентирована на ENS-подобный маппинг (`0x123...` -> `name.tempo`). Для ИИ-агентов функциональность простого маппинга признана недостаточной. 
**Новая цель:** Переход к инфраструктуре "Agentic Passport", где основой обнаружения агента являются его машиночитаемые компетенции (`capabilities`), а регистрация инициируется самим агентом.

## 2. Экономика и Балансы (Account Abstraction)
Агент должен обладать финансовой автономией для оплаты газа и взаимодействия с протоколами.
* **Требование:** Агент имеет собственный баланс в сети Tempo.
* **Вектор реализации:** Использование Account Abstraction (ERC-4337). Агент управляет смарт-аккаунтом. Внедрение Paymaster позволит спонсировать стартовые транзакции (например, онбординг), пока агент не заработает собственные средства.

## 3. Хранение Метаданных (IPFS)
* **Текущий статус:** Паспорт агента (JSON-манифест) уже успешно сохраняется в IPFS. 
* **Требование:** Сохранить эту логику. Смарт-контракт TNS должен хранить только CID (хеш) IPFS-файла, минимизируя on-chain нагрузку.

## 4. Безопасность: Связка Owner ↔ Agent
Критически важное обновление. В текущей реализации отсутствует строгая иерархия владения.
* **Требование:** Контракт должен жестко связывать управляющий адрес (`ownerAddress`) и рабочий адрес агента (`agentAddress`).
* **Логика:**
  1. `ownerAddress` (человек/DAO) генерирует криптографическую подпись (EIP-712), разрешающую конкретному `agentAddress` зарегистрироваться под определенным доменом `.tempo`.
  2. Агент прикладывает эту подпись к транзакции регистрации.
  3. Контракт `require(verifySignature(...))` предотвращает захват доменов чужими ботами.

## 5. Аттестация и Компетенции (ERC-8004 Alignment)
* **Identity (Self-Attestation):** В IPFS-манифесте агент самостоятельно декларирует массив `capabilities` (навыки, принимаемые форматы, поддерживаемые протоколы).
* **Validation (Post-facto):** Оставить задел в контрактах для связи с Validation/Reputation реестрами. Оценка реальных навыков будет происходить на основе истории успешно выполненных и верифицированных транзакций, а не на этапе премодерации.

## 6. Автоматический Онбординг (Agent-Driven Registration)
Необходимо уйти от ручного заполнения форм в UI для категории "Bot".
* **Процесс (Zero-Touch Onboarding):**
  1. Разработчик передает агенту промпт со ссылкой на техническое задание (например, `tns.xyz/register/skill.md`).
  2. В `skill.md` описан ABI контракта TNS, формат JSON-паспорта и логика загрузки в IPFS.
  3. Агент (LLM) самостоятельно анализирует свои инструменты, собирает валидный JSON манифест и пушит его в IPFS.
  4. Агент формирует транзакцию `registerAgent(string name, string ipfsCID, bytes ownerSignature)` и отправляет ее в сеть Tempo.